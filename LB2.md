**Лабораторная работа №2: резервное копирование, восстановление и 
мониторинг в Debian и PostgreSQL** 

Изучить способы резервного копирования баз данных PostgreSQL и восстановления 
их в среде Debian. Освоить базовые инструменты мониторинга системы и сервиса 
PostgreSQL. 

# 1. Утилиты резервного копирования 
### Изучить и сравнить pg_dump и pg_basebackup. Описать сценарии применения каждой утилиты.

pg_dump: Логический бэкап (SQL), отдельных БД/таблиц, медленное восстановление, межверсионная совместимость. Утилита для создания логических дампов отдельных баз данных PostgreSQL. Она извлекает данные в виде SQL-команд, которые можно выполнить для восстановления базы.

pg_basebackup: Физический бэкап (бинарный), всего кластера, быстрое восстановление, только для той же версии. Утилита для создания физических бэкапов всего кластера PostgreSQL (всех баз данных). Она копирует бинарные файлы данных с сервера, создавая полную копию на момент бэкапа.

**Когда использовать?**

pg_dump:
 - Бэкап отдельных БД/таблиц
 - Перенос между версиями PostgreSQL
 - Экспорт структуры без данных
 - Малые/средние БД

pg_basebackup:
 - Полный бэкап кластера
 - Настройка репликации
 - Быстрое восстановление (Disaster Recovery)
 - Развертывание идентичных сред
 - Требует соответсвующих прав от пользователя ```CREATE USER backup_user WITH REPLICATION LOGIN PASSWORD 'secure_password';```

# 2. Создание резервной копии 
### Выполнить полное резервное копирование (dump) базы данных из лаб. №1. Использовать параметры (например, -Fc, -Ft, обязательно посмотреть другие параметры!), объяснить разницу. 

Plain (текстовый SQL) – -Fp (по умолчанию)
- Вывод в виде читаемого SQL-скрипта
- Нет сжатия (размер бэкапа ≈ размеру данных в БД)
- Можно редактировать вручную перед восстановлением
- Подходит для мелких БД или переноса между разными версиями PostgreSQL
  
        pg_dump -U user -d dbname -Fp -f backup.sql

Custom (бинарный) – -Fc
- Бинарный формат со сжатием (экономит место)
- Поддержка параллельного восстановления (pg_restore -j N)
- Возможность выборочного восстановления объектов
- Самый быстрый для больших БД

        pg_dump -U user -d dbname -Fc -f backup.dump

Directory (каталог) – -Fd

 - Создает каталог с отдельными файлами для каждой таблицы
 - Поддержка многопоточности при дампе (-j N)
 - Автоматическое сжатие (как в Custom)
 - Удобен для частичного восстановления

         pg_dump -U user -d dbname -Fd -f backup_dir/

Tar (архив) – -Ft
 - Создает .tar-архив (можно распаковать стандартными утилитами)
 - Каждая таблица – отдельный файл в архиве
 - Поддержка сжатия через -Z (gzip) или --compress=0-9
 - Ограничение: размер файла не должен превышать 8 GB
   
       pg_dump -U user -d dbname -Ft -f backup.tar
   
![image](https://github.com/user-attachments/assets/000aa149-2bd0-4734-a3dd-7ddb958238de)

Для создания полной копии БД будем использовать команду

    pg_dump -U postgres -d postgres -Fp -f backup.sql

Т.к. точной директории при создании дамба я не указала, файл бэкапа сохраниться в ```/home/username/backup.sql.``` 

Команда для восстановления:

    psql -U user -d new_dbname -f backup.sql

# 3. Частичное (выборочное) резервное копирование Сделать дамп только определённой схемы (например, test_schema, созданной в ЛР №1). Сделать дамп только определённых таблиц из схемы public. Объяснить, в чём отличие от резервного копирования всей базы.    
