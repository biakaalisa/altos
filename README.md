# 1. Подготовка среды Установить на виртуальной машине Debian 11/12 (VMware\VirtualBox\HyperV\WSL). Убедиться, что система обновлена (команда apt-get update && apt-get upgrade – обязательно понимать разницу команд).
![image](https://github.com/user-attachments/assets/f13ed0a6-b49a-4cc2-b4b6-d310b0ddee55)
apt-get update – обновляет о доступных пакетах. Проверяет репозитории на наличие новых версий, но не устанавливает их.

apt-get upgrade - устанавливает обновления для уже установленных пакетов.

apt install – для установки новых пакетов

apt – пакетный менеджер для управления пакетами

пакеты — это архивы, содержащие программное обеспечение, библиотеки, конфигурационные файлы и метаданные, необходимые для установки и управления программами в системе. Пакеты упрощают установку, обновление и удаление программ, а также управление зависимостями между ними.


1.	http://security.debian.org/debian-security bookworm-security InRelease:
  Это репозиторий безопасности для Debian. Он содержит обновления, связанные с безопасностью, для вашей версии Debian (в данном случае — bookworm). InRelease — это файл, содержащий информацию о пакетах в репозитории, включая их подписи для проверки подлинности.

2.	http://deb.debian.org/debian bookworm InRelease:
  Это основной репозиторий Debian для версии bookworm. Он содержит большинство пакетов, включая основные программы и библиотеки. InRelease — аналогично, файл с информацией о пакетах.

3.	http://deb.debian.org/debian bookworm-updates InRelease:
  Это репозиторий обновлений для версии bookworm. Он содержит обновления пакетов, которые не связаны с безопасностью, но важны для стабильности и функциональности системы. InRelease — файл с информацией о пакетах.
![image](https://github.com/user-attachments/assets/77f466a1-8561-400a-aea5-075456cbf02e)


# 2. Установка PostgreSQL С помощью пакетного менеджера apt установить PostgreSQL (последнюю доступную версию из репозиториев). Привести команды установки и их объяснение.

![image](https://github.com/user-attachments/assets/1379022a-5cec-406b-96e1-ed64880672a6)
![image](https://github.com/user-attachments/assets/67452356-206b-458f-a0da-8f57b43567fe)
Для установки PostgreSQL использовали команду

      sudo apt install postgresql

sudo: Выполнение команд, требующих прав root
   
apt: Пакетный менеджер для управления пакетами


Отличие sudo от su:

  +	sudo выполняет одну команду с правами root, а su переключает пользователя на root (или другого пользователя) до тех пор, пока вы не выйдете из сессии.

  +	sudo требует пароль текущего пользователя, а su — пароль целевого пользователя (обычно root).
  ![image](https://github.com/user-attachments/assets/c8e66491-6dde-4e0b-b461-64b99bdbd25d)
После установки при помощи sudo systemctl status postgresql проверили статус postgres, точно ли он установился и правильно ли он работает.
# 3. Создание служебной учётной записи. Проверить, что при установке создана учётная запись postgres. Объяснить её назначение и права в системе.

![image](https://github.com/user-attachments/assets/0ecfaf49-cdf1-4cd7-aa9b-49b28b887aba)
      
Командой sudo -i -u postgres переключились на пользователя postgres

         sudo -i -u postgres
         
1.	sudo:
   
  +	Это команда, которая позволяет выполнять другие команды с привилегиями суперпользователя (root) или другого пользователя. В данном случае она используется для переключения на пользователя postgres.

2.	-i:
   
  +	Этот флаг указывает sudo запустить интерактивную оболочку (login shell). Это означает, что будет загружена среда пользователя, включая его переменные окружения, профили и настройки оболочки.
  
  +	По сути, это аналогично входу в систему как пользователь postgres.

3.	-u postgres:
   
  +	Этот флаг указывает sudo переключиться на пользователя postgres. Вместо выполнения команды от имени root, команда будет выполнена от имени указанного пользователя.
  После того, как зашли postgres-пользователем запустили терминал PostgreSQL командой
  
        psql
      
Назначение пользователя postgres:

  + Пользователь postgres создаётся автоматически при установке PostgreSQL. Он является владельцем всех файлов, связанных с PostgreSQL.
    
  + Пользователь postgres используется для запуска и остановки сервера PostgreSQL.
    
  + Все процессы PostgreSQL (например, postmaster) запускаются от имени этого пользователя.
    
  + Пользователь postgres имеет полный доступ ко всем базам данных, таблицам и другим объектам в PostgreSQL.
    
  + Он может создавать, изменять и удалять базы данных, пользователей и роли.



Права пользователя postgres:

  + Пользователь postgres является владельцем каталога данных PostgreSQL (например, /var/lib/postgresql).
    
  + Он имеет права на чтение, запись и выполнение в этом каталоге и его подкаталогах.
    
  + Внутри PostgreSQL пользователь postgres имеет роль суперпользователя (superuser).
    
  + Пользователь postgres обычно не имеет прав суперпользователя (root) в системе. Это сделано для безопасности. Однако он может выполнять команды, связанные с управлением PostgreSQL, такие как запуск и остановка сервера.

# 4.	Первичная настройка конфигурационных файлов Найти и изучить основные файлы конфигурации PostgreSQL (например, postgresql.conf, pg_hba.conf). Внести изменения (например, задать порт, при необходимости изменить метод аутентификации) и перезапустить сервис PostgreSQL.
![image](https://github.com/user-attachments/assets/b8d06a45-ee81-4a88-8f26-1162ea97c950)

Файл postgresql.conf в самом начале. Будем менять строку listen_adress, отвечающую за настройку сетевых интерфейсов (именно в ней прописаны адреса, с которых доступно подключение к postgresql). По умолчанию у данного параметра стоит значение localhost, что значит, что подключение доступно только в Debian. Для того, чтобы в дальнейшем иметь возможность подключения и в window на нашем устройстве, заменим значение этого параметра на *,  тем самым давая возможность подключения со всех адресов.
![image](https://github.com/user-attachments/assets/74aab156-91c0-4b59-a44e-5d48baa35d3a)
  Командой sudo nano /etc/postgresql/15/main/postgresql.conf заходим в файл и редактируем строку, описанную выше. 
  
        sudo nano /etc/postgresql/15/main/postgresql.conf
        
Сохраняем изменения и перезапускаем нас сервер при помощи 

      sudo systemctl restart postgresql

![image](https://github.com/user-attachments/assets/0e91f39e-981f-41e2-8eb7-7d9e32c99b85)

# 5. Управление сервисом Использовать инструменты управления сервисами Debian (systemd) — проверить статус сервиса PostgreSQL, включить автозапуск.
![image](https://github.com/user-attachments/assets/37027ee2-b11a-4f81-a132-16cb3e4b7fc5)

Для включения автозапуска использовали команду sudo systemctl enable postgresql (enable - подкоманда systemctl, которая включает автозапуск сервиса при загрузке системы)

      sudo systemctl enable postgresql

# 6. Создание тестовой базы данных Создать отдельного пользователя (логин задать в формате ФИО, например, alpopov) в PostgreSQL, новую базу данных (нейминг аналогичен dbalpopov), задать ему пароль. Использовать psql, чтобы проверить доступ      
![image](https://github.com/user-attachments/assets/bd0bd9f2-e98c-4953-b68e-a9086eb72d6b)
![image](https://github.com/user-attachments/assets/a7a82a90-acde-430e-8859-9fe06887cb98)
![image](https://github.com/user-attachments/assets/403264c5-49fb-4016-b431-71fbd16c96b3)

Для создания нового пользователя использовали PSQL-запись:

      CREATE USER <userName> WITH PASSWORD ‘<userPassword>’;

После этого для нового пользователя создали базу данных, так же используя PSQL-запись:

      CREATE DATABASE <dbName> OWNER <userName>;

Для того, чтобы проверить, точно ли все создалось как надо использовали команды:
+	\du -  возвращает список пользователей (ролей) в PostgreSQL, а также их атрибуты и привилегии.
+	\l - возвращает список баз данных на сервере PostgreSQL.

При входе в psql от лица нового пользователя была проблема в том, postgres ругался на проверку подлинности нового пользователя, связано это было с тем, что в файле pg_hba.conf была строка:

                    local 	all		all		peer,
                                   
В которой значение peer говорит о том, что postgresql разрешает подключение только тем пользователям, что есть в системе Linux. Чтобы это исправить и сделать возможным вход по паролю пользователя заменили peer на md5

                    local 	all		all		md5
                                   
после этого любой пользователь postgresql может войти использую свой пароль, который мы ранее использовали для создания.
![image](https://github.com/user-attachments/assets/0c07f2e1-529d-4da7-b890-cd794b556846)
Далее, для подключения к базе от лица нового пользователя прописали:

      psql -U <userName> -d <dbName> -W

И для окончательной проверки того, что зашли мы не от лица postgres вызвала командой 

      SELECT current_user;  
      
имя пользователя текущей сессии.
![image](https://github.com/user-attachments/assets/32476b87-1f0d-4baf-95c8-874e985c4c68)

Однако, когда мы пошли делать следующие задания столкнулись с проблемой, что теперь перед запуском psql требуется пароль postgres-пользователя, который мы не задавали и который пустым не являлся. Далее в лабораторной работе мы его поменяем, но пока, чтобы обойти эту проблему в pg_hba.conf вернули строку

                    local 	all		all		peer
 
